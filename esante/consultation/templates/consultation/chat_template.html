{% load static %}
<style>
  #react-app-chat {
    height: 90vh; /* Prend toute la hauteur de l'écran */
    width: 90%;   /* Prend toute la largeur de l'écran */
    transition: width 0.5s ease; /* Animation pour le changement de largeur */
  }

  #second-panel {
    height: 90vh; /* Prend toute la hauteur de l'écran */
    width: 400px;  /* Largeur fixe pour le deuxième panneau */
    transition: all 0.5s ease; /* Animation pour les changements de styles */
  }
</style>

<div class="flex flex-col md:flex-row items-center justify-center h-full p-6 space-y-5 md:space-y-0 md:space-x-5">
  <!-- React App Container for the other React component -->  
<<<<<<< HEAD
  <div id="react-app-chat" class=" rounded-lg overflow-hidden shadow-md "></div>

  <!-- Button to show 2nd panel -->
  <button id="show-panel-btn" class="h-14 w-14 bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center transition duration-300 ease-in-out transform hover:bg-blue-700 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-50">
  <i class="fas fa-plus text-2xl"></i> <!-- Icône Font Awesome -->
</button>


  <!-- 2nd panel (hidden initially) -->
  <div id="second-panel" class="hidden h-full  bg-gray-200 rounded-lg overflow-hidden shadow-md  flex-col  transition-all duration-500">
=======
  <div id="react-app-chat" class="h-full rounded-lg overflow-hidden shadow-md bg-white"></div>

  <!-- 2nd panel (hidden initially) -->
  <div id="second-panel" class="hidden h-full bg-gray-200 rounded-lg overflow-hidden shadow-md flex flex-col transition-all duration-500">
>>>>>>> develop
    <div class="bg-gray-500 p-4 flex justify-between items-center">
      <select id="dropdown" class="bg-white text-gray-700 p-2 rounded-lg w-1/3">
        <option value="" selected disabled>---</option>
        {% if user.user_type == 'medecin' %}
        <option value="ia-assistant">IA assistant</option>
        {% endif %}
        <option value="medical-record">Dossier médical</option>
        <option value="consultation-planning">Planning de consultation</option>
      </select>
      <button id="close-panel-btn" class="text-white hover:text-red-500 hover:underline transition-all">Fermer</button>
    </div>
    <div id="ia-assistant" class="hidden h-full w-full">
      {% include 'consultation/ia_assistant.html' %}
    </div>
    <!-- Div du bas qui prend le reste de la hauteur -->
    <div class="flex-grow m-4" id="content-area">
      <!-- Le contenu pour les autres options sera inséré ici via AJAX -->
    </div>
  </div>

  <!-- Button to show 2nd panel -->
  <button id="show-panel-btn" class="absolute top-4 right-4 h-12 w-12 bg-blue-500 text-white text-3xl rounded-full shadow-lg hover:bg-blue-600 transition duration-200">
    +
  </button>
</div>

<script>
  window.currentUser = "{{ request.user.username }}";  // Injecte le nom d'utilisateur actuel
  window.memberId = "{{ membre.id }}";  // Injecte l'ID du membre (sélectionné ou connecté)
  window.userType = "{{request.user.user_type}}"; // 

  const showPanelBtn = document.getElementById('show-panel-btn');
  const secondPanel = document.getElementById('second-panel');
  const closePanelBtn = document.getElementById('close-panel-btn');
  const dropdown = document.getElementById('dropdown');
  const contentArea = document.getElementById('content-area');
  const iaAssistantDiv = document.getElementById('ia-assistant');

  // Show second panel and hide "+" button
  showPanelBtn.addEventListener('click', function() {
    secondPanel.classList.remove('hidden');
    showPanelBtn.classList.add('hidden');

    // Réduire la largeur de la première div
    const reactAppChat = document.getElementById('react-app-chat');
    reactAppChat.style.width = 'calc(100% - 400px)'; // Ajuste selon la largeur de ton deuxième panneau
  });

  // Close second panel and show "+" button
  closePanelBtn.addEventListener('click', function() {
    secondPanel.classList.add('hidden');
    showPanelBtn.classList.remove('hidden');

    // Restaurer la largeur de la première div
    const reactAppChat = document.getElementById('react-app-chat');
    reactAppChat.style.width = '90%'; // Rétablit la largeur initiale
  });

  // Dropdown selection logic
  dropdown.addEventListener('change', function() {
    const value = this.value;
    const memberId = window.memberId;

    // Gérer le cas où IA assistant est sélectionné
    if (value === 'ia-assistant') {
      iaAssistantDiv.classList.remove('hidden');  // Afficher le div IA assistant
      contentArea.innerHTML = '';  // Vider le reste du contenu dans le content-area
      contentArea.classList.add('hidden');  // Afficher le div IA assistant
    } else {
      iaAssistantDiv.classList.add('hidden');  // Cacher le div IA assistant
      contentArea.classList.remove('hidden'); 
      let url = '';

      // Charger les autres options via AJAX
      if (value === 'medical-record') {
        url = `/dossier-medical/${memberId}/`;
      } else if (value === 'consultation-planning') {
        url = '/planning/';
      }

      // Charger la page partiellement via AJAX
      if (url) {
        fetch(url, { headers: { 'X-Requested-With': 'XMLHttpRequest' } })
          .then(response => response.text())
          .then(html => {
            contentArea.innerHTML = html;  // Insérer le contenu HTML chargé
          })
          .catch(error => {
            console.error('Erreur lors du chargement via AJAX:', error);
          });
      }
    }
  });

  // Initialiser la sélection par défaut au chargement de la page
  window.onload = function() {
    dropdown.value = "";  // Sélectionner l'option vide par défaut
  };
</script>

<!-- Include the Vite-built React app -->
<link rel="stylesheet" href="{% static 'react/assets/index-01.css' %}">
<script type="module" src="{% static 'react/assets/index-01.js' %}"></script>